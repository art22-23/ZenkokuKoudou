<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ドキュメンタリー映画「金福童」特設サイト</title>
  <style>
    /* CSS Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Arial', sans-serif;
      background: #f4f4f4;
      line-height: 1.6;
      scroll-behavior: smooth;
      color: #333;
    }
    header {
      background: linear-gradient(135deg, #ff6b6b, #f8e473);
      color: #fff;
      padding: 20px;
      text-align: center;
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    header h1 {
      font-size: 2rem;
      margin-bottom: 10px;
    }
    nav {
      margin-top: 10px;
    }
    nav a {
      color: #fff;
      margin: 0 12px;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s;
    }
    nav a:hover {
      color: #ffd700;
    }
    .container {
      max-width: 1200px;
      margin: 120px auto 20px auto; /* 上部は固定ヘッダー分の余白 */
      padding: 20px;
    }
    section {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 40px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h2 {
      margin-bottom: 20px;
      border-bottom: 2px solid #ffd700;
      padding-bottom: 10px;
      font-size: 1.8rem;
      color: #444;
    }
    /* テーブルスタイル */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }
    th {
      background: #fafafa;
    }
    /* 予告編用レスポンシブiframe */
    .trailers iframe {
      width: 100%;
      height: 315px;
      border: none;
      border-radius: 8px;
    }
    /* 自主上映募集用リンク */
    .apply-link {
      display: inline-block;
      margin-right: 10px;
      margin-top: 15px;
      padding: 10px 20px;
      background: #555;
      color: #fff;
      text-decoration: none;
      border-radius: 5px;
      transition: background 0.3s;
    }
    .apply-link:hover {
      background: #333;
    }
    /* エラーメッセージ */
    .error-message {
      background-color: #ffdddd;
      border-left: 6px solid #f44336;
      margin-bottom: 15px;
      padding: 10px;
      color: #333;
    }
  </style>
</head>
<body>
  <header>
    <h1>ドキュメンタリー映画「金福童」特設サイト</h1>
    <nav>
      <a href="#screenings">上映情報</a>
      <a href="#info">映画情報</a>
      <a href="#trailers">予告編</a>
      <a href="#feedback">感想</a>
      <a href="#invite">自主上映</a>
    </nav>
  </header>

  <div class="container" id="root"></div>

  <!-- 外部ライブラリの読み込み -->
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Framer Motion（アニメーション用ライブラリ） -->
  <script src="https://unpkg.com/framer-motion/dist/framer-motion.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

  <!-- React を用いたモダンなHPのメインスクリプト -->
  <script type="text/babel">
    const { useState, useEffect } = React;
    const { motion } = window.framerMotion || {};
    if (!motion) {
      console.error("Framer Motion が正しく読み込まれていません。");
    }

    // CSVデータから上映情報を読み込むコンポーネント
    const Screenings = () => {
      const [upcomingScreenings, setUpcomingScreenings] = useState([]);
      const [pastScreenings, setPastScreenings] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      const [regionMap, setRegionMap] = useState({});

      const formatDate = (dateStr) => {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}/${month}/${day}`;
      };

      const groupByRegion = (screenings) => {
        const grouped = {};
        screenings.forEach(screening => {
          const city = screening.city || '';
          const region = regionMap[city] || '未分類';
          if (!grouped[region]) {
            grouped[region] = [];
          }
          grouped[region].push(screening);
        });
        const regionOrder = ['北海道', '東北', '関東', '中部', '近畿', '中国', '四国', '九州', '沖縄', '未分類'];
        return regionOrder.filter(region => grouped[region] && grouped[region].length > 0)
                          .map(region => ({
                            region,
                            screenings: grouped[region]
                          }));
      };

      useEffect(() => {
        const fetchData = async () => {
          try {
            const screeningsText = await fetch('screenings.csv').then(res => res.text());
            const regionsText = await fetch('regions.csv').then(res => res.text());

            // CSVの解析（PapaParse利用）
            const regionData = Papa.parse(regionsText, {
              header: true,
              skipEmptyLines: true
            });
            const regionMapping = {};
            regionData.data.forEach(row => {
              if (row.city && row.region) {
                regionMapping[row.city] = row.region;
              }
            });
            setRegionMap(regionMapping);

            const result = Papa.parse(screeningsText, {
              header: true,
              skipEmptyLines: true,
              dynamicTyping: true,
              transformHeader: header => header.trim(),
              transform: (value, field) => field === 'date' && value ? formatDate(value) : value
            });

            if (result.errors.length > 0) {
              console.error('CSV解析エラー:', result.errors);
              setError('データの読み込み中にエラーが発生しました。');
            } else {
              const now = new Date();
              const sortedData = result.data.sort((a, b) => {
                const dateA = new Date(a.date.split('/').join('-'));
                const dateB = new Date(b.date.split('/').join('-'));
                return dateA - dateB;
              });
              const upcoming = [];
              const past = [];
              sortedData.forEach(screening => {
                const screeningDate = new Date(screening.date.split('/').join('-'));
                if (screeningDate >= now) {
                  upcoming.push(screening);
                } else {
                  past.push(screening);
                }
              });
              setUpcomingScreenings(upcoming);
              setPastScreenings(past);
            }
          } catch (err) {
            console.error('データ読み込みエラー:', err);
            setError('データの読み込み中にエラーが発生しました。');
          } finally {
            setLoading(false);
          }
        };

        fetchData();
      }, []);

      if (loading) return <p>データを読み込み中...</p>;
      if (error) return <p className="error-message">{error}</p>;

      return (
        <motion.div
          id="screenings"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
        >
          <section>
            <h2>今後の上映情報</h2>
            {upcomingScreenings.length === 0 ? (
              <p>現在予定されている上映情報はありません。</p>
            ) : (
              <table>
                <thead>
                  <tr>
                    <th>日付</th>
                    <th>時間</th>
                    <th>会場</th>
                    <th>主催</th>
                    <th>リンク</th>
                  </tr>
                </thead>
                <tbody>
                  {upcomingScreenings.map((screening, index) => (
                    <tr key={index}>
                      <td>{screening.date}</td>
                      <td>{screening.time || '-'}</td>
                      <td>{screening.venue || '-'}</td>
                      <td>{screening.organizer || '-'}</td>
                      <td>
                        {screening.link ? (
                          <a href={screening.link} target="_blank" rel="noopener noreferrer">詳細</a>
                        ) : (
                          '-'
                        )}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            )}
          </section>

          <section>
            <h2>過去の上映情報</h2>
            <details>
              <summary>過去の上映情報を表示する</summary>
              {groupByRegion(pastScreenings).map(({ region, screenings }) => (
                <div key={region}>
                  <h3>{region}</h3>
                  <table>
                    <thead>
                      <tr>
                        <th>日付</th>
                        <th>開催地</th>
                        <th>会場</th>
                        <th>主催</th>
                        <th>報告</th>
                      </tr>
                    </thead>
                    <tbody>
                      {screenings.map((screening, idx) => (
                        <tr key={idx}>
                          <td>{screening.date}</td>
                          <td>{screening.city || '-'}</td>
                          <td>{screening.venue || '-'}</td>
                          <td>{screening.organizer || '-'}</td>
                          <td>
                            { screening.report_link && screening.report_link !== '-' ? (
                                <a href={screening.report_link} target="_blank" rel="noopener noreferrer">報告を見る</a>
                              ) : (
                                ''
                              )
                            }
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              ))}
            </details>
          </section>
        </motion.div>
      );
    };

    // 映画紹介セクション
    const InfoSection = () => (
      <motion.section 
        id="info"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6, delay: 0.2 }}
      >
        <h2>映画について</h2>
        <p>本作は、日本軍「慰安婦」被害者である金福童さんの人生を描いた作品です。</p>
        <p>日本軍の性奴隷とされた金福童さんが1992年の名乗り出以降、問題の解決を訴えながら出会いを重ね、社会の不条理に苦しむ人々を励まし、手を取ってともに歩む姿が描かれています。2019年1月、金福童さんが亡くなられ、その生を多くの人に知ってもらおうとドキュメンタリー映画「金福童」が製作されました。私たちはこの映画をぜひ多くの日本の皆さんにも見てほしいと考え、全国各地での上映を進めています。金福童さんの生き方に共感し、感動した、勇気と希望をもらったという多くの声が届いています。</p>
        <p>監督：宋元根 （ソン・ウォングン） | 制作年：2019年 | 制作会社：ニュースタパ | 上映時間：101分</p>
        <h2>壮絶な生があり、希望に満ちた死があった。</h2>
        <p>その死を悼んで「女性人権運動家・金福童市民葬」には6千人が集まった。</p>
        <p>人々はなぜそれほどまでに彼女を慕い、敬い、その死を惜しんだのか。</p>
        <p>その理由が今、明かされる。</p>
        <p>日本軍性奴隷の被害を乗り越えて、人々に平和と希望の尊さを訴え続けた金福童。</p>
        <p>韓国映画『金福童』は、その闘いの軌跡だ。</p>
        <h2>＜金福童さんについて＞</h2>
        <p>14歳で連行され、中国、シンガポール、インドネシア等の戦場を連れ回された。1992年、周囲の反対を押し切って名乗り出た。2010年より、韓国挺身隊問題対策協議会（挺対協）のシェルター「平和のウリチプ（我が家）」で暮らして以降、その発言と行動力で人権活動家と呼ばれた。2012年3月8日、国際女性デーに吉元玉（キル・ウォノク）ハルモニとともに「ナビ（蝶）基金」を設立。コンゴ、ウガンダ、ナイジェリア、シリアなどの紛争地で性暴力被害に苦しむ女性や、ベトナム戦争の時、韓国軍による性暴力被害に遭った女性たちを支援。2015年の「日韓合意」には、「お金で歴史を売った」と抗議し、政府を提訴するなど先頭で闘う。病に苦しみながらも、朝鮮学校の子どもたちを支援しようと「金福童の希望」基金を設立し、亡くなられる直前まで日本を訪れ子どもたちの羽ばたきを励ました。</p>
      </motion.section>
    );

    // 予告編セクション
    const TrailersSection = () => (
      <motion.section
        id="trailers"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6, delay: 0.4 }}
        className="trailers"
      >
        <h2>予告編動画</h2>
        <iframe src="https://www.youtube.com/embed/h_GMQhBKHKg?si=q99kQlwt_xzxKwbu" allowFullScreen></iframe>
        <iframe src="https://www.youtube.com/embed/TyMO_5L97kg?si=3-tjcbnmSrt4LuCz" allowFullScreen></iframe>
      </motion.section>
    );

    // 視聴者の感想セクション
    const FeedbackSection = () => (
      <motion.section
        id="feedback"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6, delay: 0.6 }}
        className="feedback"
      >
        <h2>視聴者の感想</h2>
        <ul>
          <li>始まって10分くらいから終わりまで涙が止まらなかった。ハルモニのお人柄や言葉に感動。忘れずに、しっかりと周りに伝えていくのが自分の使命だと思った。</li>
          <li>過剰にエモーショナルではなく、また金さんを神格化するでもなく、淡々としているのに、彼女自身の内側からみなぎる存在感に圧倒された。そしてガン闘病中のスピーチ、背筋が伸びて表情がとてもとても美しかった。</li>
          <li>「何度も見たくなる、感動作です。」</li>
          <li>1人のハルモニを追ったドキュメンタリーは見たことがなかったので、金福童ハルモニの言葉1つ1つが直接語りかけてくれているように思った。ハルモニの貴重な声を残してくださったことにありがとうと言いたい。</li>
          <li>「希望」は勝ち取るもの……。本当にそうだと思った。ハルモニが職員の方に「○○」と毎日声をかける姿は、孤立無援で1人かたくなに闘っているのではなく、手に手を取って心つなぎ歴史の中に生きる1人の人間なのだと、伝わってきた。</li>
          <li>金福童ハルモニの人生が、人権活動家、被害者としてだけでなく人間としてこの映画の中でうつしだされていて、ハルモニがどのような思いで生きてきたのかを感じることができた。亡くなる最期まで闘っていて、正義感や未来世代の思いが強い方だなと思った。</li>
          <li>素晴らしい映画だった。声を上げて以降の金福童さんのお顔立ちが引き締まった一種独特の美しい相貌へと変わっていく様子や、一被害者、証言者の立場から平和運動家・人権活動家としての意識やナラティブを獲得いていく様に深い感銘を受けた。金さんを支える女性たちや朝鮮学校の少女たちに思いを寄せる金さんのお姿に、世代を超えたシスターフッドを感じたいへん励まされた。</li>
          <li>金福童さんや彼女をサポートするコミュニティの方々の強い怒りややるせない思いが伝わってきた。金福童さんが放った言葉はどれも印象強く、特に、「口が使えるまで戦う」というセリフは彼女が一生涯賭けて抵抗してきたことの現れであると感じた。</li>
          <li>ぼやんと認識していた「慰安婦」問題について、韓国目線で（被害者、当事者目線で）学ぶことができた。映画の冒頭で「90歳を過ぎても日本軍慰安婦被害者という過去が付きまとう」という言葉があって、とても印象に残った。</li>
        </ul>
      </motion.section>
    );

    // 自主上映勧誘セクション
    const InviteSection = () => (
      <motion.section
        id="invite"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.6, delay: 0.8 }}
        className="invite"
      >
        <h2>あなたの街でも自主上映しませんか？</h2>
        <p>全国行動は、映画「金福童」の自主上映を広げるため、韓国の配給会社(株)イェンナフィルムへの取り次ぎや広報のお手伝いをさせていただきます。みなさまの地域やグループ等で上映会を希望される場合は以下にご連絡、ご相談ください。</p>
        <p>お問い合わせはこちらまで：i_zenkokukoudou@yahoo.co.jp</p>
        <p>
          <a className="apply-link" href="https://drive.google.com/file/d/1Y-OvZ_sh8AXq1v6yctd0OkG73aODAxGJ/view?usp=sharing" target="_blank">
            上映会開催について
          </a>
          <a className="apply-link" href="https://docs.google.com/document/d/1oLQeWWynLZ4nLoCn7yRmYEURkSIDMLwH/edit?usp=sharing" target="_blank">
            上映会開催の申込書
          </a>
        </p>
      </motion.section>
    );

    // メイン App コンポーネント
    const App = () => (
      <div>
        <Screenings />
        <InfoSection />
        <TrailersSection />
        <FeedbackSection />
        <InviteSection />
      </div>
    );

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
